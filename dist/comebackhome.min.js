!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.Comebackhome=n()}(this,function(){function e(e,n){return new RegExp(" "+n+" ").test(" "+e.className+" ")}var n={};n.shuffle=function(e){for(var n,t,o=e.length;o;n=Math.floor(Math.random()*o),t=e[--o],e[o]=e[n],e[n]=t);return e};var t=[].slice;n.extend=function(){var e,n,o,c,a=t.call(arguments),r=a[0];for(e=1,n=a.length;n>e;e++){c=a[e];for(o in c)c.hasOwnProperty(o)&&(r[o]=c[o])}return r};var o=function(e){var n;try{n=JSON.parse(e.responseText)}catch(t){n=e.responseText}return[n,e]},c=function(e,n){var t,o=[];for(t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n&&o.push("_t="+Date.now()),o.join("&")};n.getJSON=function(e,n){var t={success:function(){},error:function(){}},a=window.XMLHttpRequest||ActiveXObject,r=new a("MSXML2.XMLHTTP.3.0");return n&&(e+="?"+c(n)),r.open("get",e,!0),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t.success.apply(t,o(r)):t.error.apply(t,o(r)))},r.send(n),{success:function(e){return t.success=e,t},error:function(e){return t.error=e,t}}},n.addEvent=function(e,n,t){return e.attachEvent?e.attachEvent("on"+n,t):e.addEventListener(n,t,!1)},n.toggleClass=function(n,t){var o=" "+n.className.replace(/[\t\r\n]/g," ")+" ";if(e(n,t)){for(;o.indexOf(" "+t+" ")>=0;)o=o.replace(" "+t+" "," ");n.className=o.replace(/^\s+|\s+$/g,"")}else n.className+=" "+t},n.ready=function(e){var n=!1,t=!0,o=document.documentElement,c=document.addEventListener,a=c?"addEventListener":"attachEvent",r=c?"removeEventListener":"detachEvent",i=c?"":"on",s=function(t){("readystatechange"!=t.type||"complete"==document.readyState)&&(("load"==t.type?window:document)[r](i+t.type,s,!1),!n&&(n=!0)&&e.call(window,t.type||t))},d=function(){try{o.doScroll("left")}catch(e){return void setTimeout(d,50)}s("poll")};if("complete"==document.readyState)e.call(window,"lazy");else{if(!c&&o.doScroll){try{t=!window.frameElement}catch(l){}t&&d()}document[a](i+"DOMContentLoaded",s,!1),document[a](i+"readystatechange",s,!1),window[a](i+"load",s,!1)}};var a="http://comebackhome.org/api/v1/person/",r="https://freegeoip.net/json/",i={limit:6},s=function(e){return n.getJSON(a,n.extend({},i,e))},d=n.getJSON.bind(n,r),l=!1,m=function(e,t){if(!l){l=!0;var o=document.createElement("div");o.innerHTML=u.body(),e.appendChild(o);var c=document.getElementById("comebackhome-container"),a=document.getElementById("comebackhome-panel"),r=document.getElementById("comebackhome-results");n.addEvent(c,"click",function(){n.toggleClass(a,"comebackhome-show")});var m=u.items;d().success(function(e){t=n.extend({lat:Math.round(e.latitude),lon:Math.round(e.longitude)},i,t),s(t).success(function(e){var t=n.shuffle(e.objects);r.innerHTML=m(t)})})}};m.getData=s,n.ready(function(){m(document.body,{})});var u={};return u.body=function(){var e='<div id="comebackhome-container"> <div class="comebackhome-header"> <div class="comebackhome-pulluptab">â–² Help find missing people</div> <div class="comebackhome-title">404 Person Not Found</div> </div> <div id="comebackhome-panel"> <ul id="comebackhome-results"></ul> </div></div>';return e},u.items=function(e){var n="",t=e;if(t)for(var o,c=-1,a=t.length-1;a>c;)o=t[c+=1],n+='<li class="comebackhome-person-frame"> <a href="'+o.url+'" target="_blank"> <div class="comebackhome-person-column"> <img class="comebackhome-person-picture" src="http://res.cloudinary.com/comebackhome/image/fetch/w_150,h_150,c_fill,f_auto,g_face:center,e_grayscale/'+o.thumbnail_url+'" alt='+o.name+'> </div> <div class="comebackhome-person-column comebackhome-person-info"> <div class="comebackhome-person-name">'+o.display_name+'</div> <div class="comebackhome-person-location">'+o.display_location+'</div> <div class="comebackhome-person-extra"> Missing since '+new Date(o.since).toDateString()+" ",it.age_now&&(n+=" <br> Age now: "+o.age_now+" "),n+=" </div> </div> </a></li>";return n},m});