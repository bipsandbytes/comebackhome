!function(e,o){"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?module.exports=o():e.Comebackhome=o()}(this,function(){function e(e,o){return new RegExp(" "+o+" ").test(" "+e.className+" ")}var o={};o.shuffle=function(e){for(var o,t,n=e.length;n;o=Math.floor(Math.random()*n),t=e[--n],e[n]=e[o],e[o]=t);return e};var t=[].slice;o.extend=function(){var e,o,n,a,c=t.call(arguments),r=c[0];for(e=1,o=c.length;o>e;e++){a=c[e];for(n in a)a.hasOwnProperty(n)&&(r[n]=a[n])}return r};var n=function(e){var o;try{o=JSON.parse(e.responseText)}catch(t){o=e.responseText}return[o,e]},a=function(e,o){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o&&n.push("_t="+Date.now()),n.join("&")};o.getJSON=function(e,o){var t={success:function(){},error:function(){}},c=window.XMLHttpRequest||ActiveXObject,r=new c("MSXML2.XMLHTTP.3.0");return o&&(e+="?"+a(o)),r.open("get",e,!0),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t.success.apply(t,n(r)):t.error.apply(t,n(r)))},r.send(o),{success:function(e){return t.success=e,t},error:function(e){return t.error=e,t}}},o.addEvent=function(e,o,t){return e.attachEvent?e.attachEvent("on"+o,t):e.addEventListener(o,t,!1)},o.toggleClass=function(o,t){var n=" "+o.className.replace(/[\t\r\n]/g," ")+" ";if(e(o,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");o.className=n.replace(/^\s+|\s+$/g,"")}else o.className+=" "+t},o.ready=function(e){var o=!1,t=!0,n=document.documentElement,a=document.addEventListener,c=a?"addEventListener":"attachEvent",r=a?"removeEventListener":"detachEvent",i=a?"":"on",s=function(t){("readystatechange"!=t.type||"complete"==document.readyState)&&(("load"==t.type?window:document)[r](i+t.type,s,!1),!o&&(o=!0)&&e.call(window,t.type||t))},m=function(){try{n.doScroll("left")}catch(e){return void setTimeout(m,50)}s("poll")};if("complete"==document.readyState)e.call(window,"lazy");else{if(!a&&n.doScroll){try{t=!window.frameElement}catch(l){}t&&m()}document[c](i+"DOMContentLoaded",s,!1),document[c](i+"readystatechange",s,!1),window[c](i+"load",s,!1)}};var c="http://comebackhome.org/api/v1/person/",r="https://freegeoip.net/json/",i={limit:6},s=function(e){return o.getJSON(c,o.extend({},i,e))},m=o.getJSON.bind(o,r),l=!1,d=function(e,t){if(!l){l=!0;var n=document.createElement("div");n.innerHTML=p.body(),e.appendChild(n);var a=document.getElementById("comebackhome-container"),c=document.getElementById("comebackhome-panel"),r=document.getElementById("comebackhome-results");o.addEvent(a,"click",function(){o.toggleClass(c,"comebackhome-show")});var d=p.items;m().success(function(e){t=o.extend({lat:Math.round(e.latitude),lon:Math.round(e.longitude)},i,t),s(t).success(function(e){var t=o.shuffle(e.objects);r.innerHTML=d(t)})})}};d.getData=s,o.ready(function(){d(document.body,{})});var p={};p.body=function(){var e='<div id="comebackhome-container"> <div class="comebackhome-header"> <div class="comebackhome-pulluptab">â–² Help find missing people</div> <div class="comebackhome-title">404 Person Not Found</div> </div> <div id="comebackhome-panel"> <ul id="comebackhome-results"></ul> </div></div>';return e},p.items=function(e){var o="",t=e;if(t)for(var n,a=-1,c=t.length-1;c>a;)n=t[a+=1],o+='<li class="comebackhome-person-frame"> <a href="'+n.url+'" target="_blank"> <div class="comebackhome-person-column"> <img class="comebackhome-person-picture" src="http://res.cloudinary.com/comebackhome/image/fetch/w_150,h_150,c_fill,f_auto,g_face:center,e_grayscale/'+n.thumbnail_url+'" alt='+n.name+'> </div> <div class="comebackhome-person-column comebackhome-person-info"> <div class="comebackhome-person-name">'+n.display_name+'</div> <div class="comebackhome-person-location">'+n.display_location+'</div> <div class="comebackhome-person-extra"> Missing since '+new Date(n.since).toDateString()+" ",n.age_now&&(o+=" <br> Age now: "+n.age_now+" "),o+=" </div> </div> </a></li>";return o};var u=document.createElement("style");u.setAttribute("type","text/css");var h='#comebackhome-container{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;width:100%;max-height:100%;position:absolute;bottom:0;left:0;background-color:#fff;z-index:100000;position:fixed}.comebackhome-header{padding:20px;color:#eee;background-color:#ec6952;cursor:pointer;}.comebackhome-header .comebackhome-title{font-size:18px;line-height:21.599999999999998px}.comebackhome-header .comebackhome-subheading{font-size:14px;line-height:16.8px;float:right}.comebackhome-header .comebackhome-pulluptab{position:absolute;top:-30px;color:#eee;background-color:#ec6952;right:10px;-webkit-border-radius:10px;border-radius:10px;padding:10px}#comebackhome-panel{display:none;padding-top:15px}.comebackhome-show{display:block !important}#comebackhome-results{overflow:hidden;margin:0;padding-left:0;list-style-type:none}.comebackhome-person-frame{width:33%;float:left;margin-bottom:20px;}.comebackhome-person-frame:nth-of-type(3n + 1){clear:left}.comebackhome-person-name{margin-top:15%;color:#ec6952;font-size:16px;line-height:19.2px}.comebackhome-person-location{color:#666;font-size:14px;line-height:16.8px}.comebackhome-person-extra{margin-top:30px;color:#999;font-size:12px;line-height:14.399999999999999px}.comebackhome-person-picture{display:block;margin:10px auto;width:100%;max-width:150px;max-height:150px;-webkit-border-radius:50%;border-radius:50%}.comebackhome-person-column{width:50%;position:relative;float:left;text-align:left}';"textContent"in u?u.textContent=h:u.styleSheet.cssText=h;var f=document.getElementsByTagName("head")[0];return f.appendChild(u),d});